#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running tests before push..."
echo ""

# Run unit tests
echo "ğŸ“ Running unit tests..."
pnpm test

if [ $? -ne 0 ]; then
  echo ""
  echo "âŒ Unit tests failed. Please fix the tests before pushing."
  exit 1
fi

echo ""
echo "âœ… Unit tests passed!"
echo ""

# Run e2e tests (only for auth service for now)
echo "ğŸš€ Running E2E tests..."
cd apps/apis/auth && pnpm test:e2e
TEST_EXIT_CODE=$?
cd ../../..

if [ $TEST_EXIT_CODE -ne 0 ]; then
  echo ""
  echo "âŒ E2E tests failed. Please fix the tests before pushing."
  exit 1
fi

echo ""
echo "âœ… E2E tests passed!"
echo ""
echo "ğŸ‰ All tests passed! Proceeding with push..."

